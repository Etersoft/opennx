From 18d38fcd5f5f72c765cf6f22e257344773a7a873 Mon Sep 17 00:00:00 2001
From: Victor Korablin <korablin@etersoft.ru>
Date: Tue, 30 Jul 2013 12:57:57 +0400
Subject: [PATCH 17/25] Add Num Lock state as a parameter to be send
To: wine-patches <wine-patches@winehq.org>
Reply-To: wine-devel <wine-devel@winehq.org>

---
 opennx/MyXmlConfig.cpp | 11 +++++++++++
 opennx/MyXmlConfig.h   |  1 +
 2 files changed, 12 insertions(+)

diff --git a/opennx/MyXmlConfig.cpp b/opennx/MyXmlConfig.cpp
index 9dccadf..df49916 100644
--- a/opennx/MyXmlConfig.cpp
+++ b/opennx/MyXmlConfig.cpp
@@ -48,6 +48,8 @@
 #include <wx/url.h>
 #include <wx/config.h>
 #include <wx/display.h>
+#include <wx/utils.h>
+#include <wx/defs.h>
 
 class wxConfigBase;
 
@@ -905,6 +907,15 @@ MyXmlConfig::sGetSessionParams(const long protocolVersion, bool bNew, const wxSt
         // so we simply leave it out for shadow sessions.
         ret << wxT(" --aux=\"1\"");
     }
+    
+    m_bNumLockEnabled = wxGetKeyState (::WXK_NUMLOCK);
+    if(m_bNumLockEnabled){
+	ret << wxT("--numlock=\"on\"");
+    }
+    else{
+	ret << wxT(" --numlock=\off\"");
+    }
+    
     return ret;
 }
 
diff --git a/opennx/MyXmlConfig.h b/opennx/MyXmlConfig.h
index 7e0b1df..27f9194 100644
--- a/opennx/MyXmlConfig.h
+++ b/opennx/MyXmlConfig.h
@@ -447,6 +447,7 @@ class MyXmlConfig
         bool m_bDisableDirectDraw;
         bool m_bGrabKeyboard;
         bool m_bDisableDeferredUpdates;
+        bool m_bNumLockEnabled;
 
         int m_iCupsPort;
         int m_iDisplayHeight;
-- 
1.8.4.3

