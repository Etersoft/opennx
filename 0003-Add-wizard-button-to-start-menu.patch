From ab566db3846c705be49f14d412e592b863a4c7f7 Mon Sep 17 00:00:00 2001
From: Sergey Mitrofanov <sergeym@etersoft.ru>
Date: Thu, 3 Jan 2013 15:40:00 +0400
Subject: [PATCH 03/22] Add wizard button to start menu
To: wine-patches <wine-patches@winehq.org>
Reply-To: wine-devel <wine-devel@winehq.org>

---
 opennx/LoginDialog.cpp | 22 +++++++++++++++++++++-
 opennx/LoginDialog.h   |  4 ++++
 opennx/res/opennx.xrc  |  8 ++++++++
 3 files changed, 33 insertions(+), 1 deletion(-)

diff --git a/opennx/LoginDialog.cpp b/opennx/LoginDialog.cpp
index df292bd..a62a935 100644
--- a/opennx/LoginDialog.cpp
+++ b/opennx/LoginDialog.cpp
@@ -54,6 +54,7 @@
 #include "Icon.h"
 #include "opennxApp.h"
 #include "SupressibleMessageDialog.h"
+#include "MyWizard.h"
 
 ////@begin XPM images
 ////@end XPM images
@@ -90,6 +91,8 @@ BEGIN_EVENT_TABLE( LoginDialog, wxDialog )
     EVT_BUTTON( XRCID("ID_BUTTON_CONFIGURE"), LoginDialog::OnButtonConfigureClick )
 
     EVT_BUTTON( wxID_OK, LoginDialog::OnOkClick )
+    
+    EVT_BUTTON( XRCID("wxID_WIZARD"), LoginDialog::OnButtonWizardClick )
 
     ////@end LoginDialog event table entries
 
@@ -244,6 +247,7 @@ bool LoginDialog::Create( wxWindow* parent, wxWindowID WXUNUSED(id), const wxStr
     m_pCtrlGuestLogin = NULL;
     m_pCtrlConfigure = NULL;
     m_pCtrlLoginButton = NULL;
+    m_pCtrlWizardButton = NULL;
     ////@end LoginDialog member initialisation
 
     ////@begin LoginDialog creation
@@ -267,7 +271,7 @@ bool LoginDialog::Create( wxWindow* parent, wxWindowID WXUNUSED(id), const wxStr
 
 void LoginDialog::CreateControls()
 {
-
+	
     ////@begin LoginDialog content construction
     if (!wxXmlResource::Get()->LoadDialog(this, GetParent(), _T("ID_DIALOG_LOGIN")))
         wxLogError(wxT("Missing wxXmlResource::Get()->Load() in OnInit()?"));
@@ -278,6 +282,7 @@ void LoginDialog::CreateControls()
     m_pCtrlGuestLogin = XRCCTRL(*this, "ID_CHECKBOX_GUESTLOGIN", wxCheckBox);
     m_pCtrlConfigure = XRCCTRL(*this, "ID_BUTTON_CONFIGURE", wxButton);
     m_pCtrlLoginButton = XRCCTRL(*this, "wxID_OK", wxButton);
+    m_pCtrlWizardButton = XRCCTRL(*this, "wxID_WIZARD", wxButton);
     // Set validators
     if (FindWindow(XRCID("ID_TEXTCTRL_USERNAME")))
         FindWindow(XRCID("ID_TEXTCTRL_USERNAME"))->SetValidator( wxGenericValidator(& m_sUsername) );
@@ -379,6 +384,21 @@ wxIcon LoginDialog::GetIconResource( const wxString& name )
     return CreateIconFromFile(name);
 }
 
+void LoginDialog::OnButtonWizardClick( wxCommandEvent& event )
+{
+	MyWizard wz(NULL);
+	if(!wz.Run())
+	     return;
+	ReadConfigDirectory();
+	m_sSessionName = wz.sGetConfigName();
+	MyXmlConfig cfg(m_sSessionName);
+	m_pCtrlSessionName->Append(cfg.sGetName(), (void *)m_sSessionName.c_str());
+    m_pCtrlSessionName->SetStringSelection(cfg.sGetName());
+    wxCommandEvent event2;
+    OnComboboxSessionSelected(event2);
+}
+
+
 /*!
  * wxEVT_COMMAND_BUTTON_CLICKED event handler for ID_BUTTON_CONFIGURE
  */
diff --git a/opennx/LoginDialog.h b/opennx/LoginDialog.h
index c9db382..70098da 100644
--- a/opennx/LoginDialog.h
+++ b/opennx/LoginDialog.h
@@ -119,6 +119,8 @@ private:
 
     /// wxEVT_COMMAND_BUTTON_CLICKED event handler for wxID_OK
     void OnOkClick( wxCommandEvent& event );
+    
+    void OnButtonWizardClick( wxCommandEvent& event );
 
 ////@end LoginDialog event handler declarations
 
@@ -160,6 +162,8 @@ private:
     wxCheckBox* m_pCtrlGuestLogin;
     wxButton* m_pCtrlConfigure;
     wxButton* m_pCtrlLoginButton;
+    wxButton* m_pCtrlWizardButton;
+    
 private:
     wxString m_sUsername;
     wxString m_sPassword;
diff --git a/opennx/res/opennx.xrc b/opennx/res/opennx.xrc
index fe684a9..27936ac 100644
--- a/opennx/res/opennx.xrc
+++ b/opennx/res/opennx.xrc
@@ -133,6 +133,14 @@
                     <object class="sizeritem">
                         <flag>wxALIGN_CENTER_VERTICAL|wxALL</flag>
                         <border>5</border>
+                        <object class="wxButton" name="wxID_WIZARD">
+                            <label>&amp;Wizard</label>
+                            <default>1</default>
+                        </object>
+                    </object>
+                    <object class="sizeritem">
+                        <flag>wxALIGN_CENTER_VERTICAL|wxALL</flag>
+                        <border>5</border>
                         <object class="wxButton" name="wxID_OK">
                             <label>L&amp;ogin</label>
                             <default>1</default>
-- 
2.1.4

